<nav class="site-nav">
  <div class="nav-wrap">
    <a class="brand" href="index.html">Chronicle</a>
    <button class="menu-toggle" aria-label="Toggle navigation">&#9776;</button>
    <ul class="links">
      <li><a href="index.html">Home</a></li>
      <li><a href="powers.html">Great Powers</a></li>
      <li><a href="samogitia.html">Samogitia Evolution</a></li>
      <li><a href="armies.html">Armies</a></li>
      <li><a href="navies.html">Royal Navy</a></li>
      <li><a href="rulers.html">Rulers &amp; Advisors</a></li>
      <li><a href="economy.html">Economy</a></li>
      <li><a href="maps.html">Atlas</a></li>
      <li><a href="timeline.html">Timeline</a></li>
    </ul>
    <input id="searchBox" type="text" placeholder="Search...">
    <button id="themeToggle" class="theme-toggle" aria-label="Toggle theme">Toggle Theme</button>
  </div>
</nav>

<script>
  (function(){
    const here = location.pathname.replace(/\/+$/,'');
    document.querySelectorAll('.site-nav .links a').forEach(a=>{
      const link = a.getAttribute('href').replace(/\/+$/,'');
      if (link && (here.endsWith(link) || (here.endsWith('/SamogitianChronicle') && link.endsWith('/index.html')))) {
        a.classList.add('active');
      }
    });

    if(document.getElementById('themeToggle')){
      const themeScript = document.createElement('script');
      themeScript.src = 'assets/js/theme.js';
      themeScript.defer = true;
      document.head.appendChild(themeScript);
    }

    if(document.getElementById('searchBox')){
      const lunrScript = document.createElement('script');
      lunrScript.src = 'https://cdn.jsdelivr.net/npm/lunr/lunr.min.js';
      lunrScript.onload = () => {
        const searchScript = document.createElement('script');
        searchScript.src = 'assets/js/search.js';
        document.head.appendChild(searchScript);
      };
      document.head.appendChild(lunrScript);
    }

    if('serviceWorker' in navigator){
      navigator.serviceWorker.register('/service-worker.js');
    }
  })();
</script>
=======
<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/service-worker.js');
  }
</script>
  <script src="assets/js/theme.js" defer></script>
  <script src="assets/js/navToggle.js" defer></script>
=======

